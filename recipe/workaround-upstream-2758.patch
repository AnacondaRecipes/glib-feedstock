See: https://gitlab.gnome.org/GNOME/glib/-/issues/2758

diff --git a/glib/gmessages.c b/glib/gmessages.c
index bbea253..9b525ee 100644
--- a/glib/gmessages.c
+++ b/glib/gmessages.c
@@ -612,8 +612,12 @@ write_string_sized (FILE        *stream,
   /* Is it nul-terminated? */
   if (length < 0)
     write_string (stream, string);
-  else
-    fwrite (string, 1, length, stream);
+  else {
+    if (fwrite (string, 1, length, stream) < length) {
+      /* -Werror=unused-result forces us to "handle" this condition
+       * but there's nothing useful to do here. */
+    }
+  }
 }
 
 static GLogDomain*
diff --git a/glib/tests/fileutils.c b/glib/tests/fileutils.c
index 247bcef..37f53d5 100644
--- a/glib/tests/fileutils.c
+++ b/glib/tests/fileutils.c
@@ -1424,7 +1424,7 @@ test_get_contents (void)
   const gchar *filename = "file-test-get-contents";
 
   f = g_fopen (filename, "w");
-  fwrite (text, 1, strlen (text), f);
+  g_assert_cmpint(fwrite (text, 1, strlen (text), f), ==, strlen(text));
   fclose (f);
 
   if (g_test_undefined ())
